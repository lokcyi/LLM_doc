【MCP 正夯，但這些資安漏洞你注意到了嗎？】

Anthropic 推出的 Model Context Protocol（MCP）被不少開發者視為「AI 界的 USB‑C」——想接資料源、掛外部工具，一條標準化通道就能搞定。然而方便的另一面，往往暗藏資安地雷。

以下提供MCP風險網路整理, 依 風險等級由低→高 排列，逐一拆解六大常見漏洞，並提供對應防禦心法: 

1. 【風險：低】Persistent Context—上下文被「偷改」的小破口
MCP 在整個工作階段持續紀錄上下文，方便代理人跨步驟追蹤；若伺服器遭竄改，攻擊者可插入或修改歷史訊息，誘導 LLM 判斷失準。

防禦要點:
 ✅為每筆上下文加上雜湊或電子簽章，確保完整性。
 ✅設定最短保留期限並定期清除不必要的會話，降低風險面積。


2. 【風險：中】Command Injection—提示詞也能變後門
若未對自然語言指令做過濾，攻擊者只要在提示詞埋入惡意語意，就能讓代理人執行未授權動作（例如下載敏感檔案）。

防禦要點:
 ✅以語意白名單或正規化過濾輸入指令。
 ✅在工具層加入參數驗證，並採最小權限原則。


3. 【風險：中】Server‑Sent Events（SSE）問題—長連線拖慢也拖垮安全
SSE 長時間開放連線，若缺乏加密或節流機制，容易被插封包、重放或阻斷服務，造成資料外洩與延遲暴增。

防禦要點
 ✅全程使用 TLS，並為每段資料加入一次性 nonce 防重放。
 ✅實作指數回退及最大連線時限，避免「永遠掛線」。


4. 【風險：高】Tool Poisoning—把「工具箱」變「毒藥箱」
第三方工具若被植入惡意程式碼，可竄改回傳結果或竊取 API 金鑰與私有資料。

防禦要點
 ✅針對所有工具伺服器執行 SBOM（軟體組件清單）與持續漏洞掃描。
 ✅透過沙箱化限制網路與檔案系統存取權限。


5. 【風險：高】Privilege Escalation—惡意工具搶奪話語權
若惡意工具能攔截或覆寫對其他可信工具的呼叫，就能橫向移動、提升權限，取得更廣的操作範圍。

防禦要點
 ✅為工具呼叫路由加上簽章，阻斷未授權的轉向。
 ✅每個工具獨立配置 API Token，避免單點洩漏。


6. 【風險：高】Server Data Takeover—一個洞，整座伺服器失守
攻擊者掌控某工具伺服器後，若憑證或 ACL 設計不良，便可滲透其他 MCP 伺服器，奪取所有使用者資料與密碼。

防禦要點
 ✅採零信任架構，工具伺服器彼此永不共用憑證。
 ✅佈署持續監控與異常行為偵測，偵測到外洩趨勢立即斷線。


 ▶把「協定」當「基建」來管理

MCP 讓「資料即插即用」成為可能，同時也把 Web 應用與 LLM 的複合風險帶進企業內部。唯有在設計 → 開發 → 佈署 → 營運整個生命週期落實資安治理，才能讓這條高速公路保持順暢，又不成為駭客的自助餐。
